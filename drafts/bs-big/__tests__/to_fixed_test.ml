open Jest

let () =
  describe "to_fixed_test" (fun () ->
  let open Expect in

  let to_fixed_test_opt =
    let count = ref 0 in
    fun (exp, x, dp) ->
      count := !count + 1;
      let v = Big.fromString x |. Big.toFixed ~dp:dp () in
      test ("to_fixed_test_opt" ^ string_of_int !count) (fun () -> expect v |> toBe exp)
  in
  let to_fixed_test_no_opt =
    let count = ref 0 in
    fun (exp, x) ->
      count := !count + 1;
      let v = Big.fromString x |. Big.toFixed () in
      test ("to_fixed_test_opt" ^ string_of_int !count) (fun () -> expect v |> toBe exp)
  in
  Big.setDP 20;
  Big.setRM 1;

    to_fixed_test_opt ("0.0", "0", 1);
    to_fixed_test_opt ("0.0", "0", 1);
    to_fixed_test_opt ("0.0", "-0", 1);
    to_fixed_test_opt ("0.00", "-0", 2);

    to_fixed_test_opt ("100.0", "99.9512986", 1);
    to_fixed_test_opt ("10.0", "9.95036", 1);
    to_fixed_test_opt ("1.0", "0.99", 1);
    to_fixed_test_opt ("0.10", "0.09906", 2);
    to_fixed_test_opt ("0.010", "0.0098034", 3);

    to_fixed_test_opt ("1111111111111111111111.00000000", "1111111111111111111111", 8);
    to_fixed_test_opt ("0.1", "0.1", 1);
    to_fixed_test_opt ("0.10", "0.1", 2);
    to_fixed_test_opt ("0.100", "0.1", 3);
    to_fixed_test_opt ("0.01", "0.01", 2);
    to_fixed_test_opt ("0.010", "0.01", 3);
    to_fixed_test_opt ("0.0100", "0.01", 4);
    to_fixed_test_opt ("0.00", "0.001", 2);
    to_fixed_test_opt ("0.001", "0.001", 3);
    to_fixed_test_opt ("0.0010", "0.001", 4);
    to_fixed_test_opt ("1.0000", "1", 4);
    to_fixed_test_opt ("1.0", "1", 1);
    to_fixed_test_opt ("1", "1", 0);
    to_fixed_test_opt ("12", "12", 0);
    to_fixed_test_opt ("1", "1.1", 0);
    to_fixed_test_opt ("12", "12.1", 0);
    to_fixed_test_opt ("1", "1.12", 0);
    to_fixed_test_opt ("12", "12.12", 0);
    to_fixed_test_opt ("0.0000006", "0.0000006", 7);
    to_fixed_test_opt ("0.00000006", "0.00000006", 8);
    to_fixed_test_opt ("0.000000060", "0.00000006", 9);
    to_fixed_test_opt ("0.0000000600", "0.00000006", 10);
    to_fixed_test_opt ("0", "0", 0);
    to_fixed_test_opt ("0.0", "0", 1);
    to_fixed_test_opt ("0.00", "0", 2);

    to_fixed_test_opt ("-1111111111111111111111.00000000", "-1111111111111111111111", 8);
    to_fixed_test_opt ("-0.1", "-0.1", 1);
    to_fixed_test_opt ("-0.10", "-0.1", 2);
    to_fixed_test_opt ("-0.100", "-0.1", 3);
    to_fixed_test_opt ("-0.01", "-0.01", 2);
    to_fixed_test_opt ("-0.010", "-0.01", 3);
    to_fixed_test_opt ("-0.0100", "-0.01", 4);
    to_fixed_test_opt ("-0.00", "-0.001", 2);
    to_fixed_test_opt ("-0.001", "-0.001", 3);
    to_fixed_test_opt ("-0.0010", "-0.001", 4);
    to_fixed_test_opt ("-1.0000", "-1", 4);
    to_fixed_test_opt ("-1.0", "-1", 1);
    to_fixed_test_opt ("-1", "-1", 0);
    to_fixed_test_opt ("-1", "-1.1", 0);
    to_fixed_test_opt ("-12", "-12.1", 0);
    to_fixed_test_opt ("-1", "-1.12", 0);
    to_fixed_test_opt ("-12", "-12.12", 0);
    to_fixed_test_opt ("-0.00000", "-0.0000006", 5);
    to_fixed_test_opt ("-0.0000006", "-0.0000006", 7);
    to_fixed_test_opt ("-0.00000006", "-0.00000006", 8);
    to_fixed_test_opt ("-0.000000060", "-0.00000006", 9);
    to_fixed_test_opt ("-0.0000000600", "-0.00000006", 10);
    to_fixed_test_opt ("0", "0", 0);
    to_fixed_test_opt ("0", "-0", 0);
    to_fixed_test_opt ("0.0", "-0", 1);
    to_fixed_test_opt ("0.00", "-0", 2);
    to_fixed_test_opt ("0.00", "-0.0", 2);
    to_fixed_test_opt ("0.00", "-0.0000", 2);
    to_fixed_test_opt ("0.0000", "-0", 4);

    to_fixed_test_no_opt ("1000", "1000");
    to_fixed_test_no_opt ("0.00001", "0.00001");
    to_fixed_test_opt ("0.00001", "0.00001", 5);
    to_fixed_test_opt ("0.00000000000000000010", "0.0000000000000000001", 20);
    to_fixed_test_opt ("0.00001000000000000", "0.00001", 17);
    to_fixed_test_opt ("1.00000000000000000", "1", 17);
    to_fixed_test_no_opt ("1000000000000000128", "1000000000000000128");
    to_fixed_test_opt ("100000000000000128.0", "100000000000000128", 1);
    to_fixed_test_opt ("10000000000000128.00", "10000000000000128", 2);
    to_fixed_test_opt ("10000000000000128.00000000000000000000", "10000000000000128", 20);
    to_fixed_test_no_opt ("0", "0");
    to_fixed_test_opt ("-42.000", "-42", 3);
    to_fixed_test_no_opt ("-1000000000000000128", "-1000000000000000128");
    to_fixed_test_opt ("-0.00000000000000000010", "-0.0000000000000000001", 20);
    to_fixed_test_opt ("0.12312312312312300000", "0.123123123123123", 20);

    to_fixed_test_opt ("1", "0.5", 0);
    to_fixed_test_opt ("-1", "-0.5", 0);
    to_fixed_test_opt ("1.3", "1.25", 1);
    to_fixed_test_opt ("234.2041", "234.20405", 4);
    to_fixed_test_opt ("234.2041", "234.204050000000000000000000000000006", 4);

    Big.setRM 0;

    to_fixed_test_opt ("0.3", "0.3", 1);
    to_fixed_test_opt ("-200258348374.3", "-200258348374.3595802551014614089785610548492885372322083789", 1);
    to_fixed_test_opt ("-8996550690041157178188143247448286757711.5580857413", "-8996550690041157178188143247448286757711.55808574133329", 10);
    to_fixed_test_opt ("-3172413669280032477.00", "-3172413669280032477", 2);
    to_fixed_test_opt ("6547946357820.750067107731812021675", "6547946357820.750067107731812021675351468709784004", 21);
    to_fixed_test_opt ("24188393190716631282750407915133817062572333100239.0000000000000000000", "24188393190716631282750407915133817062572333100239", 19);
    to_fixed_test_opt ("539982361589798324286450574560330534901309503.82000000", "539982361589798324286450574560330534901309503.82", 8);
    to_fixed_test_opt ("829898800701640360552652.0000", "829898800701640360552652", 4);
    to_fixed_test_opt ("-1585782773394.4", "-1585782773394.44501382110847", 1);
    to_fixed_test_opt ("-7604844176594943774211951887242195107.399", "-7604844176594943774211951887242195107.399576743428669618164", 3);
    to_fixed_test_opt ("-0.00", "-0.0000000000000005153003506839", 2);
    to_fixed_test_opt ("0.000", "0.00003", 3);
    to_fixed_test_opt ("-5454249481540317712.560293859013731302", "-5454249481540317712.56029385901373130215526009738012974642338", 18);
    to_fixed_test_opt ("15352607654972198961429295651185206861818141054385638.00000000000000000", "15352607654972198961429295651185206861818141054385638", 17);
    to_fixed_test_opt ("91494535411039025233040.292", "91494535411039025233040.29224903220309368507011", 3);
    to_fixed_test_opt ("2043369316.0", "2043369316", 1);
    to_fixed_test_opt ("-0.0000000782350618457", "-0.0000000782350618457630647420312027682238301541350414", 19);
    to_fixed_test_opt ("2122652.0", "2122652", 1);
    to_fixed_test_opt ("-0.00841365", "-0.00841365099301981489219310202029642", 8);
    to_fixed_test_opt ("0.0", "0.0007035", 1);
    to_fixed_test_opt ("-0.00000000000000374916", "-0.0000000000000037491685778894015479084539735777088", 20);
    to_fixed_test_opt ("534883638.00", "534883638", 2);
    to_fixed_test_opt ("-2.0", "-2", 1);
    to_fixed_test_opt ("-5634442247266825358399629799939027370665.0000000000000000000", "-5634442247266825358399629799939027370665", 19);
    to_fixed_test_opt ("3331187169219186569122.000000000", "3331187169219186569122", 9);
    to_fixed_test_opt ("0.0000000000", "0.0000000000006604395609805032330367635527", 10);
    to_fixed_test_opt ("-0.0000000000000576901", "-0.00000000000005769013292086168690493327", 19);
    to_fixed_test_opt ("-661.8", "-661.828596629053201916486", 1);
    to_fixed_test_opt ("-6073555395665254434249128854999349235744174928042756.1153000000000", "-6073555395665254434249128854999349235744174928042756.1153", 13);
    to_fixed_test_opt ("-5013086846966.000", "-5013086846966", 3);
    to_fixed_test_opt ("0.004015", "0.00401523226833", 6);
    to_fixed_test_opt ("3140295374107374579919222510.1462722", "3140295374107374579919222510.1462722819395532", 7);
    to_fixed_test_opt ("-0.000000", "-0.00000000000000799876460379334679831886", 6);
    to_fixed_test_opt ("-0.00", "-0.0003", 2);
    to_fixed_test_opt ("-0.026760766726884267", "-0.026760766726884267750393307117624838556001925491", 18);
    to_fixed_test_opt ("-20821740502968847857923433558797.0899", "-20821740502968847857923433558797.08997487843745", 4);
    to_fixed_test_opt ("0.00000000002", "0.000000000020346524414696573703092255317751132892", 11);
    to_fixed_test_opt ("45492073832204366341299301624.000000000", "45492073832204366341299301624", 9);
    to_fixed_test_opt ("-22166905155222048275755520049666636.000000000000000", "-22166905155222048275755520049666636", 15);
    to_fixed_test_opt ("-0.0047749609085292677147", "-0.00477496090852926771478756451899887586311084", 22);
    to_fixed_test_opt ("0.0000000000066505751320542", "0.000000000006650575132054209449586010993453988006221893652", 25);
    to_fixed_test_opt ("-5987959.1630276586738", "-5987959.163027658673856586", 13);
    to_fixed_test_opt ("-1666.00", "-1666", 2);
    to_fixed_test_opt ("634686619827216246836355610829.00000", "634686619827216246836355610829", 5);
    to_fixed_test_opt ("-4775591515709.469953191321103401", "-4775591515709.4699531913211034017874029213583522324151968262", 18);
    to_fixed_test_opt ("-0.00209248872211", "-0.002092488722118037239933953031151990638700454763", 14);
    to_fixed_test_opt ("4592542353054190400811174084.8269203906", "4592542353054190400811174084.826920390637", 10);
    to_fixed_test_opt ("-2719622410429690231797721788738949434271171.000000000", "-2719622410429690231797721788738949434271171", 9);
    to_fixed_test_opt ("7481081126833353571249877375770446139269602514514.000000000000000", "7481081126833353571249877375770446139269602514514", 15);
    to_fixed_test_opt ("-717308374940.1455264110", "-717308374940.145526411005821148802846366045624291352081913", 10);
    to_fixed_test_opt ("-0.000000007", "-0.000000007385554720977", 9);
    to_fixed_test_opt ("-0.000861389378754506340", "-0.000861389378754506340296565696012302905659179798", 21);
    to_fixed_test_opt ("-5053251493102402525630380749.678", "-5053251493102402525630380749.6785380807585", 3);
    to_fixed_test_opt ("-4.0", "-4", 1);
    to_fixed_test_opt ("-91608.490784509096643367058", "-91608.49078450909664336705884736640894006", 21);
    to_fixed_test_opt ("0.000", "0.000000008", 3);
    to_fixed_test_opt ("-60759551763816025544062865222.0000000000", "-60759551763816025544062865222", 10);
    to_fixed_test_opt ("1052.9354577213309", "1052.93545772133093448862729794627180236152", 13);
    to_fixed_test_opt ("45267509474.0", "45267509474", 1);
    to_fixed_test_opt ("3157315152.00", "3157315152", 2);
    to_fixed_test_opt ("-0.5", "-0.5", 1);
    to_fixed_test_opt ("0.0057546", "0.005754639024965241832260499185230186", 7);
    to_fixed_test_opt ("-0.000", "-0.0006", 3);
    to_fixed_test_opt ("3230791870040253164174259086.74466486260", "3230791870040253164174259086.7446648626", 11);
    to_fixed_test_opt ("-4344423254203589122222715762047.000000", "-4344423254203589122222715762047", 6);
    to_fixed_test_opt ("0.000000", "0.00000000000000000005", 6);
    to_fixed_test_opt ("-0.00000000", "-0.0000000000000032995964759", 8);
    to_fixed_test_opt ("29342667392627.13800502090", "29342667392627.1380050209", 11);
    to_fixed_test_opt ("3553322646.0000", "3553322646", 4);
    to_fixed_test_opt ("0.0000000", "0.000000000000711595888783922", 7);
    to_fixed_test_opt ("128714169681975260747586179339689165715468750318817.0", "128714169681975260747586179339689165715468750318817", 1);
    to_fixed_test_opt ("-203846045708188631.7", "-203846045708188631.714385911896349", 1);
    to_fixed_test_opt ("6732937084326281547153681265380857817.680", "6732937084326281547153681265380857817.68", 3);
    to_fixed_test_opt ("-80645.000", "-80645", 3);
    to_fixed_test_opt ("0.0091340467346905226", "0.0091340467346905226577831006050168789952519932147436292", 19);
    to_fixed_test_opt ("765350910755641789513513452874635492095713.000000000000000000", "765350910755641789513513452874635492095713", 18);
    to_fixed_test_opt ("7619917853284.00", "7619917853284", 2);
    to_fixed_test_opt ("-7584198211496430223.4315410358218089229", "-7584198211496430223.43154103582180892294235232", 19);
    to_fixed_test_opt ("-2946097370887492968389.2786430820000", "-2946097370887492968389.278643082", 13);
    to_fixed_test_opt ("-400129748.000", "-400129748", 3);
    to_fixed_test_opt ("-76362970460470638842230785495147305876.114384970200", "-76362970460470638842230785495147305876.1143849702", 12);
    to_fixed_test_opt ("334029398796150851211670406157956664329.0000000000000", "334029398796150851211670406157956664329", 13);
    to_fixed_test_opt ("-0.000000000000", "-0.000000000000000000881892851839338487244179354", 12);
    to_fixed_test_opt ("-70475264003.0000", "-70475264003", 4);
    to_fixed_test_opt ("0.080", "0.0809", 3);
    to_fixed_test_opt ("16917787280140934145228.000", "16917787280140934145228", 3);
    to_fixed_test_opt ("25909519297999779346.000000000", "25909519297999779346", 9);
    to_fixed_test_opt ("-355224.19720319810644", "-355224.19720319810644496969482", 14);
    to_fixed_test_opt ("8482635122899359930368306655493255835883236244.0000000000000", "8482635122899359930368306655493255835883236244", 13);
    to_fixed_test_opt ("41268046802033799763539654473098094614587.00000000000000000", "41268046802033799763539654473098094614587", 17);
    to_fixed_test_opt ("8564065673925609331469179144.0", "8564065673925609331469179144", 1);
    to_fixed_test_opt ("-231732424.30838", "-231732424.3083887160672296965273691583237367", 5);
    to_fixed_test_opt ("-597740668669015342275289261436747905744110289638.43026849", "-597740668669015342275289261436747905744110289638.430268497449", 8);
    to_fixed_test_opt ("8297509140414599.000000", "8297509140414599", 6);
    to_fixed_test_opt ("-17320207086212822899.00", "-17320207086212822899", 2);
    to_fixed_test_opt ("0.00", "0.000000000002", 2);
    to_fixed_test_opt ("4972.517305", "4972.51730546661166855901714", 6);
    to_fixed_test_opt ("0.000000", "0.0000000162819653537555368724511902456803362906", 6);
    to_fixed_test_opt ("29485932208290816133111088923502731.000000", "29485932208290816133111088923502731", 6);
    to_fixed_test_opt ("0.0000", "0.000000000006", 4);

    Big.setRM 1;

    to_fixed_test_opt ("733744593401073823825766410831877679446.0000000000000000000", "733744593401073823825766410831877679446", 19);
    to_fixed_test_opt ("-64.6849459", "-64.6849458687691227978", 7);
    to_fixed_test_opt ("-0.000000", "-0.00000000009", 6);
    to_fixed_test_opt ("-62537287527837589298857228059657673223234916.95923265430000000", "-62537287527837589298857228059657673223234916.9592326543", 17);
    to_fixed_test_opt ("3393668096256773847245721315080265089731.000000", "3393668096256773847245721315080265089731", 6);
    to_fixed_test_opt ("0.0", "0.0000000000000056674956638008432348702401392", 1);
    to_fixed_test_opt ("72516372734.6", "72516372734.6447", 1);
    to_fixed_test_opt ("-418.28", "-418.2800731793741351", 2);
    to_fixed_test_opt ("0.00", "0.001", 2);
    to_fixed_test_opt ("8366217346845756726.00000000", "8366217346845756726", 8);
    to_fixed_test_opt ("-0.000000", "-0.0000000000000092034548636370987112234384736726", 6);
    to_fixed_test_opt ("0.35", "0.35474830751442135112334772517193392", 2);
    to_fixed_test_opt ("64703289793894.5830", "64703289793894.58296866", 4);
    to_fixed_test_opt ("-0.000000000000000036", "-0.000000000000000036461242408590182363418943891", 18);
    to_fixed_test_opt ("5494508405056449117588.631948", "5494508405056449117588.631948458033233759999", 6);
    to_fixed_test_opt ("-0.0", "-0.00393971618499838726739122333520030506235698", 1);
    to_fixed_test_opt ("375581290738585826632.00000000", "375581290738585826632", 8);
    to_fixed_test_opt ("254.96635275802300887", "254.96635275802300886544776010389418575738792480979736", 17);
    to_fixed_test_opt ("21492347.69467571391498624445", "21492347.6946757139149862444482880595559468", 20);
    to_fixed_test_opt ("313576441324233.0000000", "313576441324233", 7);
    to_fixed_test_opt ("-8617.57089319166", "-8617.57089319166205141433276411273552139017", 11);
    to_fixed_test_opt ("0.00000000014928376395", "0.00000000014928376394768755724252424022348932365406839448223", 20);
    to_fixed_test_opt ("2.497624215622999568569", "2.49762421562299956856937732557160934323114203547832675", 21);
    to_fixed_test_opt ("-288056106511636272271570523193926801058294502.000", "-288056106511636272271570523193926801058294502", 3);
    to_fixed_test_opt ("-4798171567575228724.140", "-4798171567575228724.1400144613946894", 3);
    to_fixed_test_opt ("8.49008", "8.49007655210654", 5);
    to_fixed_test_opt ("-56633605.000", "-56633605", 3);
    to_fixed_test_opt ("-4147381274685866.81753", "-4147381274685866.8175313", 5);
    to_fixed_test_opt ("-534460490015293367127173277346694900936058.0000", "-534460490015293367127173277346694900936058", 4);
    to_fixed_test_opt ("182707431911537249021116759327712693311898345504618668.43327000000000000000000", "182707431911537249021116759327712693311898345504618668.43327", 23);
    to_fixed_test_opt ("210005324615278.4586839690045963321032", "210005324615278.458683969004596332103244549279", 22);
    to_fixed_test_opt ("779837001772884165637922377221951347134695.644834", "779837001772884165637922377221951347134695.6448338", 6);
    to_fixed_test_opt ("-0.000001", "-0.00000064188301390033596845335767993853284632527964514979079", 6);
    to_fixed_test_opt ("13.0", "13", 1);
    to_fixed_test_opt ("0.0000001269", "0.0000001269060795648365813491128357427111184222", 10);
    to_fixed_test_opt ("18446632248354.00", "18446632248354", 2);
    to_fixed_test_opt ("-1229249.79", "-1229249.7897249259", 2);
    to_fixed_test_opt ("49082.0", "49082", 1);
    to_fixed_test_opt ("-61.0", "-61", 1);
    to_fixed_test_opt ("-893.0", "-893", 1);
    to_fixed_test_opt ("5002282278.56974877690066484", "5002282278.569748776900664839184116538222902", 17);
    to_fixed_test_opt ("41372.00", "41372", 2);
    to_fixed_test_opt ("-4732022445962399687294885123498809.7625585825095", "-4732022445962399687294885123498809.7625585825095", 13);
    to_fixed_test_opt ("-55484242.036895641", "-55484242.036895641", 9);
    to_fixed_test_opt ("-41427133134.52583323427907663268339", "-41427133134.525833234279076632683393992706825", 23);
    to_fixed_test_opt ("0.0", "0.00004300614085218825243480119971669264977421", 1);
    to_fixed_test_opt ("-472025754597316278339412186866.7010659789", "-472025754597316278339412186866.701065978877597089729906019843", 10);
    to_fixed_test_opt ("2.50869", "2.50869082352024406", 5);
    to_fixed_test_opt ("-87154.000", "-87154", 3);
    to_fixed_test_opt ("-0.0000000000071859183950976", "-0.0000000000071859183950975905578927950225183102336392", 25);
    to_fixed_test_opt ("-10827138340266.44", "-10827138340266.44057558913", 2);
    to_fixed_test_opt ("0.0000702", "0.0000701871613973530533582225769977", 7);
    to_fixed_test_opt ("-4878237667448133503521416059497.376626000000", "-4878237667448133503521416059497.376626", 12);
    to_fixed_test_opt ("8984687671347686046766702.01181862480", "8984687671347686046766702.0118186248", 11);
    to_fixed_test_opt ("0.00000", "0.00000000076447711430809658905538", 5);
    to_fixed_test_opt ("-184825.87743766370213607", "-184825.87743766370213606656669525883145102", 17);
    to_fixed_test_opt ("-147007021210433212254058959161555.747000000000", "-147007021210433212254058959161555.747", 12);
    to_fixed_test_opt ("641778680063060681850989295.4", "641778680063060681850989295.44394602812788754296411563", 1);
    to_fixed_test_opt ("0.00", "0.000000000000000261099857", 2);
    to_fixed_test_opt ("-69168585539.981086198312", "-69168585539.9810861983124008597329", 12);
    to_fixed_test_opt ("-2441638.37765", "-2441638.37765405543", 5);
    to_fixed_test_opt ("0.00", "0.00000005", 2);
    to_fixed_test_opt ("-17865480328519059654833853633.668588983", "-17865480328519059654833853633.6685889825124607147114", 9);
    to_fixed_test_opt ("5552449880075592383242782.42", "5552449880075592383242782.42273775283", 2);
    to_fixed_test_opt ("-3.47445833771303714", "-3.4744583377130371421642122331960174443", 17);
    to_fixed_test_opt ("-5543608156416096833838191852961329666675.00000000000000", "-5543608156416096833838191852961329666675", 14);
    to_fixed_test_opt ("-6836042.000", "-6836042", 3);
    to_fixed_test_opt ("0.00000912", "0.0000091177854552839774258855562071866", 8);
    to_fixed_test_opt ("55986.00", "55986", 2);
    to_fixed_test_opt ("0.0", "0.02", 1);
    to_fixed_test_opt ("-0.0000", "-0.00000001", 4);
    to_fixed_test_opt ("889659799897707059043156.0", "889659799897707059043156", 1);
    to_fixed_test_opt ("0.000000", "0.00000000000000003", 6);
    to_fixed_test_opt ("0.00000000000008179581450", "0.00000000000008179581449515246320423213581212698189913041", 23);
    to_fixed_test_opt ("-981.4210", "-981.421", 4);
    to_fixed_test_opt ("-3455913777070673553360330519337.00000000000000", "-3455913777070673553360330519337", 14);
    to_fixed_test_opt ("0.00000000081700", "0.00000000081700228716634187537384600725", 14);
    to_fixed_test_opt ("4822037.000", "4822037", 3);
    to_fixed_test_opt ("-0.0000000064360437778", "-0.0000000064360437777672775206464043731", 19);
    to_fixed_test_opt ("5290480.66496927901282867", "5290480.66496927901282867027658062129", 17);
    to_fixed_test_opt ("-408612952552043095.000", "-408612952552043095", 3);
    to_fixed_test_opt ("-513.0", "-513", 1);
    to_fixed_test_opt ("-14964.000", "-14964", 3);
    to_fixed_test_opt ("-19903753117563849440806175537514112075543387952.00000", "-19903753117563849440806175537514112075543387952", 5);
    to_fixed_test_opt ("249443.0175143", "249443.0175142727704683419749", 7);
    to_fixed_test_opt ("-74343756463586673907431837633.24", "-74343756463586673907431837633.23687651", 2);
    to_fixed_test_opt ("-27.679", "-27.6785", 3);
    to_fixed_test_opt ("-64259172643579684888737979.618833554815821332098", "-64259172643579684888737979.618833554815821332097716331", 21);
    to_fixed_test_opt ("17230955766539391.00000000", "17230955766539391", 8);
    to_fixed_test_opt ("582751886981240.177", "582751886981240.177383845390864465", 3);
    to_fixed_test_opt ("191002031658424.51", "191002031658424.51247456500221220552332700327795408", 2);
    to_fixed_test_opt ("-479015175846069070145.000000000", "-479015175846069070145", 9);
    to_fixed_test_opt ("135507.00", "135507", 2);
    to_fixed_test_opt ("-1819380757840.7931545894175", "-1819380757840.79315458941752033110677996441946221", 13);
    to_fixed_test_opt ("56729395152942371.34113220", "56729395152942371.3411322", 8);
    to_fixed_test_opt ("0.00000", "0.000000009", 5);
    to_fixed_test_opt ("231631.31091406798", "231631.310914067979514934639396351953448", 11);
    to_fixed_test_opt ("0.00", "0.00044659", 2);
    to_fixed_test_opt ("-637697600918508531049573689760309.5119477000000000", "-637697600918508531049573689760309.5119477", 16);
    to_fixed_test_opt ("-6.19247283", "-6.19247282501186063445037314", 8);

    Big.setRM 2;

    to_fixed_test_opt ("-6614662975368684488885953285955838893900074215956.00", "-6614662975368684488885953285955838893900074215956", 2);
    to_fixed_test_opt ("8642393776898.000", "8642393776898", 3);
    to_fixed_test_opt ("3612207878528.1106344698085142865", "3612207878528.1106344698085142865438924419", 19);
    to_fixed_test_opt ("977910386.93", "977910386.9343537", 2);
    to_fixed_test_opt ("-8937937492688941768401276851642629965923372.0", "-8937937492688941768401276851642629965923372", 1);
    to_fixed_test_opt ("-8327876772303865517454752161.4376112752921904774", "-8327876772303865517454752161.43761127529219047742910886", 19);
    to_fixed_test_opt ("-27707.00", "-27707", 2);
    to_fixed_test_opt ("-7287595765894242586375.92700435484", "-7287595765894242586375.927004354837723619581861634319", 11);
    to_fixed_test_opt ("-0.00000", "-0.000000000000023670858459165486137218740358207859", 5);
    to_fixed_test_opt ("574676836802209077.64156", "574676836802209077.641563875647945277493356873895", 5);
    to_fixed_test_opt ("-3041038455237222898218053653661.87952947815", "-3041038455237222898218053653661.87952947815", 11);
    to_fixed_test_opt ("-628244132307.000", "-628244132307", 3);
    to_fixed_test_opt ("316566935167341670725238.000", "316566935167341670725238", 3);
    to_fixed_test_opt ("-77953301569468294124105528.0", "-77953301569468294124105528", 1);
    to_fixed_test_opt ("0.0046", "0.00460227833968584", 4);
    to_fixed_test_opt ("4323265763616518980379929221104.0", "4323265763616518980379929221104", 1);
    to_fixed_test_opt ("1674500565014237781637959673471730398.1120033", "1674500565014237781637959673471730398.1120032995511774", 7);
    to_fixed_test_opt ("872559441430499650732600166.00000", "872559441430499650732600166", 5);
    to_fixed_test_opt ("-87858304.0000", "-87858304", 4);
    to_fixed_test_opt ("-4158788.000", "-4158788", 3);
    to_fixed_test_opt ("3983930437416823631395.9093", "3983930437416823631395.90934402583657", 4);
    to_fixed_test_opt ("-14.5531937", "-14.5531936852106573016020290135814233645752955297443336", 7);
    to_fixed_test_opt ("0.00000000002201", "0.00000000002200503795474854372849141363413146996972", 14);
    to_fixed_test_opt ("0.0000000000000", "0.00000000000000000894955653982033503846831364474746320232", 13);
    to_fixed_test_opt ("61564779.00", "61564779", 2);
    to_fixed_test_opt ("-7.0", "-7", 1);
    to_fixed_test_opt ("-0.000000000000028455976228", "-0.00000000000002845597622815028653703372125435938812845106", 24);
    to_fixed_test_opt ("728982423193598397582409707715766595902844.0000000", "728982423193598397582409707715766595902844", 7);
    to_fixed_test_opt ("14538075860529.2697937480", "14538075860529.269793748", 10);
    to_fixed_test_opt ("0.000", "0.00000000000000000007021566096", 3);
    to_fixed_test_opt ("-5136066535080.86830591678842264063462546263", "-5136066535080.86830591678842264063462546262988980471309228558", 29);
    to_fixed_test_opt ("-3026751112367460839746524832112404665.000000000000000", "-3026751112367460839746524832112404665", 15);
    to_fixed_test_opt ("-6694275398250090562.00", "-6694275398250090562", 2);
    to_fixed_test_opt ("-50643997750937725516578696636829589244661366402743.000000000", "-50643997750937725516578696636829589244661366402743", 9);
    to_fixed_test_opt ("2197374413.79714", "2197374413.7971355344377249354470626290268959873", 5);
    to_fixed_test_opt ("0.0", "0.005020192658713355", 1);
    to_fixed_test_opt ("-254956356194995318790657817617390203938.180000000", "-254956356194995318790657817617390203938.18", 9);
    to_fixed_test_opt ("0.000", "0.000000000090726", 3);
    to_fixed_test_opt ("-644164371869124953225087.14694842524000", "-644164371869124953225087.14694842524", 14);
    to_fixed_test_opt ("-0.00000157175189018", "-0.0000015717518901763532026126676445445", 17);
    to_fixed_test_opt ("883545726717772254369.08868386", "883545726717772254369.0886838593581297250598", 8);
    to_fixed_test_opt ("-8890332541208932844712909996569216422867971798.000000000000000", "-8890332541208932844712909996569216422867971798", 15);
    to_fixed_test_opt ("-0.000000000000", "-0.000000000000000019481454049470983547912235", 12);
    to_fixed_test_opt ("740944636504591431790473918513.0000", "740944636504591431790473918513", 4);
    to_fixed_test_opt ("-5679793084762496855854965276883350654245022549131067599715.800000", "-5679793084762496855854965276883350654245022549131067599715.8", 6);
    to_fixed_test_opt ("51991398836962962151.4032644162159", "51991398836962962151.4032644162159099221", 13);
    to_fixed_test_opt ("66958838053011544557752193.00000", "66958838053011544557752193", 5);
    to_fixed_test_opt ("-670579843.2118208913941229137016", "-670579843.21182089139412291370155773837719883548843299002", 22);
    to_fixed_test_opt ("-153613650899356538114572207.94248678450152160836", "-153613650899356538114572207.9424867845015216083607156497", 20);
    to_fixed_test_opt ("-737846251706379871052.2861168", "-737846251706379871052.2861168267591416289887782899835", 7);
    to_fixed_test_opt ("-65908055.0", "-65908055", 1);
    to_fixed_test_opt ("3237039120306392313.80906374769", "3237039120306392313.80906374769434099092272015749692609", 11);
    to_fixed_test_opt ("83640693821.00", "83640693821", 2);
    to_fixed_test_opt ("-921776606869800052510163986912.6037663480501", "-921776606869800052510163986912.603766348050146856757561176111", 13);
    to_fixed_test_opt ("6303883932563373.0", "6303883932563373", 1);
    to_fixed_test_opt ("6373283811.5454531478622699", "6373283811.5454531478622698611321575271", 16);
    to_fixed_test_opt ("6097017834070937658.000000000", "6097017834070937658", 9);
    to_fixed_test_opt ("24524.17471335606758880", "24524.1747133560675887965670636565353165", 17);
    to_fixed_test_opt ("82671976754257522256837287487178420454352.00000", "82671976754257522256837287487178420454352", 5);
    to_fixed_test_opt ("-4134121508878287.32516638661", "-4134121508878287.32516638661094488", 11);
    to_fixed_test_opt ("706494960751225536339363333.135485602348", "706494960751225536339363333.13548560234793", 12);
    to_fixed_test_opt ("0.0000000", "0.00000000000000000005260494554647051", 7);
    to_fixed_test_opt ("-2172823046.605754378126140867773679", "-2172823046.60575437812614086777367899344184998336", 24);
    to_fixed_test_opt ("7182216670065915047.3", "7182216670065915047.265", 1);
    to_fixed_test_opt ("-0.0001", "-0.00011347856", 4);
    to_fixed_test_opt ("-1620.4750509689199484099", "-1620.475050968919948409915128915793493745056891952647", 19);
    to_fixed_test_opt ("-2107001274569567393.00000000", "-2107001274569567393", 8);
    to_fixed_test_opt ("0.00", "0.0000000004", 2);
    to_fixed_test_opt ("-0.000", "-0.00000000000000000009622600511499459674774308", 3);
    to_fixed_test_opt ("-1749656594942211427.14080828808148814976439530", "-1749656594942211427.1408082880814881497643953004161", 26);
    to_fixed_test_opt ("-2483383057229762.00000000", "-2483383057229762", 8);
    to_fixed_test_opt ("0.000000", "0.0000005", 6);
    to_fixed_test_opt ("-0", "-0.5", 0);
 )
