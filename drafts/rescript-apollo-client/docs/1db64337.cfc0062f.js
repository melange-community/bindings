(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{62:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return p}));var r=n(2),a=n(6),o=(n(0),n(74)),i={id:"overview",title:"Overview",sidebar_label:"Overview",slug:"/"},l={unversionedId:"overview",id:"overview",isDocsHomePage:!1,title:"Overview",description:"This library provides rescript bindings to @apollo/client and related libraries. We rely on the amazing Graphql-ppx for completely typesafe GraphQL operations and fragments in Rescript. This means that even when manipulating the cache directly, you'll always be working with rescript data structures and never have to concern yourself the javascript representation of your data!",source:"@site/docs/overview.md",slug:"/",permalink:"/rescript-apollo-client/docs/",editUrl:"https://github.com/reasonml-community/rescript-apollo-client/edit/master/documentation/docs/overview.md",version:"current",sidebar_label:"Overview",sidebar:"docs",next:{title:"Installation",permalink:"/rescript-apollo-client/docs/installation"}},s=[{value:"Quick Start",id:"quick-start",children:[{value:"Records, Types, and Promises",id:"records-types-and-promises",children:[]},{value:"Use a T-First promise library",id:"use-a-t-first-promise-library",children:[]}]},{value:"Module Organization",id:"module-organization",children:[{value:"Bindings to Javascript Packages",id:"bindings-to-javascript-packages",children:[]}]},{value:"Alternatives",id:"alternatives",children:[]}],c={rightToc:s};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"This library provides rescript bindings to ",Object(o.b)("inlineCode",{parentName:"p"},"@apollo/client")," and related libraries. We rely on the amazing ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://graphql-ppx.com"}),"Graphql-ppx")," for completely typesafe GraphQL operations and fragments in Rescript. This means that even when manipulating the cache directly, you'll always be working with rescript data structures and never have to concern yourself the javascript representation of your data!"),Object(o.b)("p",null,"We provide a few ergonomic improvements for working in ReScript, but our intention is not to provide another abstraction on top of Apollo. ",Object(o.b)("strong",{parentName:"p"},"The ",Object(o.b)("a",Object(r.a)({parentName:"strong"},{href:"https://www.apollographql.com/docs/react/v3.0-beta/get-started/"}),"official Apollo Client 3 docs"),", should be your authoritative source for understanding how to work with Apollo Client.")),Object(o.b)("h2",{id:"quick-start"},"Quick Start"),Object(o.b)("p",null,"In short, the only major difference from javascript Apollo Client you should be aware of, is the appropriate hook (",Object(o.b)("inlineCode",{parentName:"p"},"useQuery"),", ",Object(o.b)("inlineCode",{parentName:"p"},"useMutation"),", etc.) is exposed as a ",Object(o.b)("inlineCode",{parentName:"p"},"use")," function on the module generated by ",Object(o.b)("inlineCode",{parentName:"p"},"graphql-ppx"),". Variables are always the last argument to a hook."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-reason"}),'module TodosQuery = %graphql(`\n  query Example ($userId: String!) {\n    user(id: $userId) {\n      id\n      name\n    }\n  }\n`)\n\n@react.component\nlet make = () =>\n  // The useQuery hook is automatically exposed on the module generated by graphql-ppx!\n  switch ExampleQuery.use({userId: "1"}) {\n    | {data: Some({users})} =>\n    ...\n  }\n}\n')),Object(o.b)("h3",{id:"records-types-and-promises"},"Records, Types, and Promises"),Object(o.b)("p",null,"This library leverages records heavily which allows for very similar syntax to working with javascript objects and other benefits, but comes with a downside. You may need to annotate the types if you're using a record in a context where the compiler cannot infer what it is. To make this less of a hassle, we expose every type from the ",Object(o.b)("inlineCode",{parentName:"p"},"ApolloClient.Types")," module."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-reason"}),'  let queryResult = SomeQuery.use()\n\n  // Destructuring works just like javascript!\n  switch queryResult {\n    | {loading: true} =>\n      // Show loading\n    | {data: Some(data), fetchMore} =>\n      let onClick = _ => fetchMore()\n      // Show data\n  }\n\n\n  apolloClient.query(~query=(module SomeQuery), ())\n  |> Js.Promise.then(result => // Hover over the type and you can see it is an ApolloQueryResult.t__ok\n    // Let\'s open the module so the record fields are accessible\n    open ApolloClient.Types.ApolloQueryResult\n    // \u261d\ufe0f You don\'t have to go searching for a type, everything is accessible under ApolloClient.Types\n    switch result {\n    | Some(apolloQueryResult) =>\n      // Now we can get at the `data` property of `apolloQueryResult`\n      Js.log2("Got data!", apolloQueryResult.data)\n    | Error(_) =>\n      Js.log("Check out EXAMPLES/ for T-first promise solutions that don\'t have this problem!")\n    }\n  )\n')),Object(o.b)("h3",{id:"use-a-t-first-promise-library"},"Use a T-First promise library"),Object(o.b)("p",null,"Type inference for records is very handy, so we highly recommend using a T-First promise library. A great choice is ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/ryyppy/rescript-promise#common-mistakes"}),"rescript-promise")," that will soon be part of core. This is what will be assumed in all examples."),Object(o.b)("h2",{id:"module-organization"},"Module Organization"),Object(o.b)("p",null,"This library packages things up into logical groups that have a consistent structure with the intent to be more disoverable and less reliant on docs. For the most part, I hope you can navigate things well from typing ",Object(o.b)("inlineCode",{parentName:"p"},"ApolloClient.")," and following the autocompletion from there. Example:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-reason"}),"// Make a generic link\nlet customLink = ApolloClient.Link.make(...)\n// Specific link types are nested under the more general module\nlet contextLink = ApolloClient.Link.ContextLink.make(...)\n// See, they're all the same :)\nlet httpLink = ApolloClient.Link.HttpLink.make(...)\n")),Object(o.b)("p",null,'While we strive to provide ergonomics that are intuitive and "reasonable", the intent is to also expose a 1:1 mapping to the javascript package structures if that is your preference. For instance, if you\'re looking in the Apollo docs and see ',Object(o.b)("inlineCode",{parentName:"p"},"import { setContext } from '@apollo/link-context'")," and you'd prefer to interact with this library in the same way, you can always access with the same filepath and name like so:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-reason"}),"module Apollo = {\n  include ApolloClient.Bindings\n};\n\n// import { setContext } from '@apollo/client/link/context'\nlet contextLink = Apollo.Client.Link.Context.setContext(...)\n// import { createHttpLink } from '@apollo/client'\nlet httpLink = Apollo.Client.createHttpLink(...)\n")),Object(o.b)("h3",{id:"bindings-to-javascript-packages"},"Bindings to Javascript Packages"),Object(o.b)("p",null,"Contains partial bindings to the following packages:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/apollographql/apollo-client"}),"@apollo/client")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/graphql/graphql-js"}),"graphql")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/apollographql/subscriptions-transport-ws"}),"subscriptions-transport-ws")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/zenparsing/zen-observable"}),"zen-observable"))),Object(o.b)("h2",{id:"alternatives"},"Alternatives"),Object(o.b)("p",null,"There are many great options for working with GraphQL in Rescript. I recommend giving them a look to see what works best for you."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/zth/reason-relay"}),"Reason Relay")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/FormidableLabs/reason-urql"}),"Reason Urql"))))}p.isMDXComponent=!0},74:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=a.a.createContext({}),p=function(e){var t=a.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=r,h=u["".concat(i,".").concat(d)]||u[d]||b[d]||o;return n?a.a.createElement(h,l(l({ref:t},c),{},{components:n})):a.a.createElement(h,l({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);