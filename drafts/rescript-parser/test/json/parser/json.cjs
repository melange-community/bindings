// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Belt_List = require("rescript/lib/js/belt_List.js");
var Belt_Array = require("rescript/lib/js/belt_Array.js");
var Res_parser = require("../../../src/res_parser.cjs");
var Belt_Option = require("rescript/lib/js/belt_Option.js");

function $$null(param) {
  return /* Null */0;
}

function true_(param) {
  return /* True */1;
}

function false_(param) {
  return /* False */2;
}

function number(number$1) {
  return {
          TAG: /* Number */1,
          _0: number$1
        };
}

function string(string$1) {
  return {
          TAG: /* String */2,
          _0: string$1
        };
}

function array(xs) {
  return {
          TAG: /* Array */3,
          _0: xs
        };
}

function object(xs) {
  return {
          TAG: /* Object */0,
          _0: xs
        };
}

function toString(t) {
  if (typeof t === "number") {
    switch (t) {
      case /* Null */0 :
          return "Null";
      case /* True */1 :
          return "True";
      case /* False */2 :
          return "False";
      
    }
  } else {
    switch (t.TAG | 0) {
      case /* Object */0 :
          return "Object()";
      case /* Number */1 :
          return "Number(" + t._0 + ")";
      case /* String */2 :
          return "String(" + t._0 + ")";
      case /* Array */3 :
          var stringify = function (xs) {
            if (xs) {
              return toString(xs.hd) + stringify(xs.tl);
            } else {
              return "";
            }
          };
          return "[" + stringify(t._0) + "]";
      
    }
  }
}

function charToString(c) {
  return String.fromCharCode(c);
}

function concatStringList(chars) {
  if (chars) {
    return chars.hd + concatStringList(chars.tl);
  } else {
    return "";
  }
}

function stringifyCharList(chars) {
  return concatStringList(Belt_List.map(chars, charToString));
}

var zero = Res_parser.$$char(/* '0' */48);

var oneThroughNine = Res_parser.satisfy(function (c) {
      if (c >= /* '1' */49) {
        return /* '9' */57 >= c;
      } else {
        return false;
      }
    });

var digit = Res_parser.map(Res_parser.orElse(zero, oneThroughNine), charToString);

var digits = Res_parser.map(Res_parser.atLeastOne(digit), concatStringList);

var sign = Res_parser.anyOf([
      /* '+' */43,
      /* '-' */45
    ]);

var fraction = Res_parser.map(Res_parser.andThen(Res_parser.$$char(/* '.' */46), digits), (function (param) {
        return String.fromCharCode(param[0]) + param[1];
      }));

var exponent = Res_parser.map(Res_parser.andThen(Res_parser.andThen(Res_parser.orElse(Res_parser.$$char(/* 'e' */101), Res_parser.$$char(/* 'E' */69)), Res_parser.optional(sign)), digits), (function (param) {
        var match = param[0];
        return String.fromCharCode(match[0]) + Belt_Option.getWithDefault(Belt_Option.map(match[1], charToString), "") + param[1];
      }));

function toString$1(param) {
  return String.fromCharCode(param[0]) + param[1];
}

var oneThroughNineThenDigits = Res_parser.map(Res_parser.andThen(oneThroughNine, digits), toString$1);

var signThenDigit = Res_parser.map(Res_parser.andThen(Res_parser.$$char(/* '-' */45), digit), toString$1);

var signThenOneThroughNineThenDigits = Res_parser.map(Res_parser.andThen(Res_parser.andThen(Res_parser.$$char(/* '-' */45), oneThroughNine), digits), (function (param) {
        var match = param[0];
        return String.fromCharCode(match[0]) + String.fromCharCode(match[1]) + param[1];
      }));

var integer = Res_parser.choice([
      oneThroughNineThenDigits,
      digit,
      signThenOneThroughNineThenDigits,
      signThenDigit
    ]);

var fraction$1 = Res_parser.optional(fraction);

var exponent$1 = Res_parser.optional(exponent);

var jsonNumber = Res_parser.map(Res_parser.andThen(Res_parser.andThen(integer, fraction$1), exponent$1), (function (param) {
        var match = param[0];
        return match[0] + Belt_Option.getWithDefault(match[1], "") + Belt_Option.getWithDefault(param[1], "");
      }));

var doubleQuote = Res_parser.$$char(/* '"' */34);

var unescapedChar = Res_parser.map(Res_parser.map(Res_parser.satisfy(function (ch) {
              if (ch > 34 || ch < 8) {
                return ch !== 92;
              } else {
                return !(ch > 33 || ch < 14);
              }
            }), (function (prim) {
            return prim;
          })), (function (prim) {
        return String.fromCharCode(prim);
      }));

var escapedChar = Res_parser.choice(Belt_Array.map([
          [
            "\\\"",
            /* '"' */34
          ],
          [
            "\\\\",
            /* '\\' */92
          ],
          [
            "\\/",
            /* '/' */47
          ],
          [
            "\\b",
            /* '\b' */8
          ],
          [
            "\\n",
            /* '\n' */10
          ],
          [
            "\\r",
            /* '\r' */13
          ],
          [
            "\\t",
            /* '\t' */9
          ]
        ], (function (param) {
            var result = param[1];
            return Res_parser.map(Res_parser.string(param[0]), (function (param) {
                          return String.fromCharCode(result);
                        }));
          })));

var backslash = Res_parser.$$char(/* '\\' */92);

var uChar = Res_parser.$$char(/* 'u' */117);

var hexdigit = Res_parser.satisfy(function (c) {
      if (c > 70 || c < 48) {
        return !(c > 102 || c < 97);
      } else {
        return c > 64 || c < 58;
      }
    });

var fourHexDigits = Res_parser.andThen(Res_parser.andThen(Res_parser.andThen(hexdigit, hexdigit), hexdigit), hexdigit);

var unicodeChar = Res_parser.map(Res_parser.keepRight(Res_parser.keepRight(backslash, uChar), fourHexDigits), (function (param) {
        var match = param[0];
        var match$1 = match[0];
        return String.fromCharCode(parseInt(String.fromCharCode(match$1[0], match$1[1], match[1], param[1]), 16));
      }));

var jsChar = Res_parser.orElse(Res_parser.orElse(unescapedChar, escapedChar), unicodeChar);

var jsonString = Res_parser.map(Res_parser.between(Res_parser.many(jsChar), doubleQuote, doubleQuote), concatStringList);

var manyWhitespace = Res_parser.many(Res_parser.anyOf([
          /* ' ' */32,
          /* '\n' */10,
          /* '\t' */9,
          /* '\r' */13
        ]));

function _charToString(c) {
  return String.fromCharCode(c);
}

var parse = Res_parser.makeRecursive(function (p) {
      var comma = Res_parser.$$char(/* ',' */44);
      var betweenBraces = function (__x) {
        return Res_parser.between(__x, Res_parser.$$char(/* '[' */91), Res_parser.$$char(/* ']' */93));
      };
      var empty = Res_parser.map(betweenBraces(manyWhitespace), (function (param) {
              return /* [] */0;
            }));
      var nonEmpty = betweenBraces(Res_parser.separatedBy1(p, comma));
      var jsonArray = Res_parser.choice([
            empty,
            nonEmpty
          ]);
      var betweenCurlyBraces = function (__x) {
        return Res_parser.between(__x, Res_parser.$$char(/* '{' */123), Res_parser.$$char(/* '}' */125));
      };
      var keyValuePair = Res_parser.andThen(Res_parser.keepLeft(Res_parser.between(jsonString, manyWhitespace, manyWhitespace), Res_parser.$$char(/* ':' */58)), p);
      var nonEmpty$1 = betweenCurlyBraces(Res_parser.separatedBy1(keyValuePair, comma));
      var empty$1 = Res_parser.map(betweenCurlyBraces(manyWhitespace), (function (param) {
              return /* [] */0;
            }));
      var jsonObject = Res_parser.choice([
            empty$1,
            nonEmpty$1
          ]);
      return Res_parser.between(Res_parser.choice([
                      Res_parser.map(Res_parser.string("null"), $$null),
                      Res_parser.map(Res_parser.string("true"), true_),
                      Res_parser.map(Res_parser.string("false"), false_),
                      Res_parser.map(jsonObject, object),
                      Res_parser.map(jsonArray, array),
                      Res_parser.map(jsonNumber, number),
                      Res_parser.map(jsonString, string)
                    ]), manyWhitespace, manyWhitespace);
    });

var $$Option;

var P;

exports.$$null = $$null;
exports.true_ = true_;
exports.false_ = false_;
exports.number = number;
exports.string = string;
exports.array = array;
exports.object = object;
exports.toString = toString;
exports.$$Option = $$Option;
exports.P = P;
exports.charToString = charToString;
exports.concatStringList = concatStringList;
exports.stringifyCharList = stringifyCharList;
exports.zero = zero;
exports.oneThroughNine = oneThroughNine;
exports.digit = digit;
exports.digits = digits;
exports.sign = sign;
exports.fraction = fraction;
exports.exponent = exponent;
exports.integer = integer;
exports.jsonNumber = jsonNumber;
exports.doubleQuote = doubleQuote;
exports.unescapedChar = unescapedChar;
exports.escapedChar = escapedChar;
exports.unicodeChar = unicodeChar;
exports.jsonString = jsonString;
exports.manyWhitespace = manyWhitespace;
exports._charToString = _charToString;
exports.parse = parse;
/* zero Not a pure module */
